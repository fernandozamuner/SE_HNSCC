# TF Analysis Pipeline

This directory contains the Ruby workflow that quantifies transcription-factor binding within super-enhancer, enhancer, and promoter domains and calculates enrichment statistics.

## Inputs
- `source_data/samples_3456_lilly_results_with_DE.annotated.tsv` and `source_data/cell_lines_lilly_results.tsv`: annotated interval tables used to build domain and shade BEDs.
- `source_data/hg19.chrom.sizes`: chromosome lengths for shade trimming.
- `source_data/hg19_cismotifs/`: per-TF BED files (A/B/C reliability tiers) from the cistrome dataset. You can symlink this folder if it lives elsewhere.

Optional interval variants rely on `source_data/*_domains_*_coverage_and_CPM.csv`, generated by the upstream domain-count pipeline.

## How It Works
1. Run `process.sh` from this directory. It will:
   - merge the cistrome TF peaks, generate domain BEDs and shade controls,
   - count overlaps between domains and TF peaks (`bedtools`),
   - compute site-vs-no-site Fisher tests and all-vs-all comparisons.
2. Outputs land in `results/` (and in `results_dse/`, `results_new/`, etc. if the optional branches are enabled). The primary deliverable is `results/sites-vs-nosites.tsv`.

The workflow does not require the CPM tablesâ€”the TF enrichment relies solely on the interval BEDs and TF peak BEDs.
